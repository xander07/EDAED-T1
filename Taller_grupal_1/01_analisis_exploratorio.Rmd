---
title: "Análisis exploratorio de la encuesta inicial"
author: "Kenneth Roy Cabrera Torres"
date: "Viernes, 26 de marzo de 2021"
modification: "Jhon Jairo Serna Córdoba, Laura Flórez, Karina Jiménez"
output: 
  html_document: 
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE)
```

## Librerías y lectura de la BD

```{r}
## Paquetes usados en el análisis.
library(tidyverse)
```
El día 24 de febrero de 2021, se inició con la primera clase del curso de estadística de descriptiva de 8 a 10 am. En ese lapso de tiempo, el profesor del curso preparó una encuesta de 44 preguntas para cada uno de los matriculados sobre temas muy diversos. A partir justamente de esos datos recolectados, se propuso como primera actividad grupal realizar una análisis descriptivo y exploratorio usando esta base de datos. En la actividad hay que resolver un entramado de 10 preguntas. A continuación se podrá ir viendo el desarrollo de cada una. 

```{r}
## Lectura de una base de datos tipo ".csv"
encuesta <- read.csv("encuesta1.csv")
```



## Visualización inicial de los datos

Esta visualización es de gran importancia, pues nos permitirá definir si nuestra base de datos necesita o no de un proceso de depuración. Con este primer acercamiento observaremos la cantidad de registros, detalles como el tipo y la estructura de los datos que conforman nuestra base de datos, lo cual, nos ayudará detectar las anomalías o errores más evidentes que pueden afectar los resultados del análísis que haremos posteriormente.

#### Visualización de la estructura general de la BD

```{r}
## Vista de la estructura general de la BD.
glimpse(encuesta)
```

En esta primera visualización nos centraremos en el tipo de dato de cada una de las variables (Columnas de la BD) para determinar si son acordes o lógicos, según nuestro criterio o necesidad. Por ejemplo, las variables que tienen formato de fecha tienen un tipo de dato apropiado para texto (Character) pero no para fechas (Date). Esta será una de las modificaciones en el proceso de depuración.

Otras variables como Genero y Carrera que son de tipo Character, podríamos cambiarlas a tipo Factor, buscando facilitar su manejo en el proceso de análisis.

Más adelante, en el proceso de depuración, veremos más detalladamente las variables que modificaremos para realizar nuestro análisis, pues ya habremos definido con cuáles vamos a trabajar. Por ahora, veámos un resumen de nuestra base de datos: 

#### Resumen general de los datos que tenemos en la BD

```{r}
summary(encuesta)
```

Como observamos, un resumen de la base de datos nos permite observar, en las variables de tipo Character, la cantidad de registros, mientras en las variables de tipo numérico (Double, Integer), nos muestra algunas estadísticas básicas de nuestras como la media, la mediana, el valor máximo y mínimo, los cuartiles, cantidad de datos faltantes, etc., ayudándonos a detectar que variables como la Q09_EnAreaMetropolitana o Q14_RecursosInformáticos deberían ser de tipo Factor, por ejemplo, y no de tipo Numérico.

Este resumen nos permite observar algunos valores atípicos, como por ejemplo, el valor máximo en la variable Q08_PAPA que es 45, superando el rango lógico [0.0, 5.0] al cual debería pertenecer.

Así, con toda la información que nos brinda la visualización general de nuestra base de datos y después de definir las variables con las que vamos a trabajar, entonces podemos empezar el proceso de depuración de nuestra base de datos.s

## Depuración de los datos

#### 1. Cambiamos los datos que tienen formato fecha de CHARACTER a DATE.
```{r}
## Convertimos la variable Enviado.el. a tipo POSIXct (DATE TIME)
encuesta <- encuesta %>% 
  mutate(Enviado.el. = as.POSIXct(strptime(Enviado.el., format = "%d/%m/%Y %H:%M:%S")))


## Convertimos la variable Q02_FechaNac a tipo DATE
encuesta <- encuesta %>% 
  mutate(Q02_FechaNac = as.Date(as.character(Q02_FechaNac), "%Y-%m-%d"))

## Convertimos la variable Q07_FechaSaber11 a tipo DATE
encuesta <- encuesta %>% 
  mutate(Q07_FechaSaber11 = as.Date(as.character(Q07_FechaSaber11),"%Y-%m-%d"))
```


#### 2. Cambiamos los datos que quedan de tipo CHARACTER a FACTOR.
```{r}
encuesta <- encuesta %>% mutate_if(is.character, as.factor)
```

#### 3. Creamos la variable estrato_etiquetado que guardará los datos de la variable estrato pero con etiquetas "Bajo, Medio, Alto".
Para esto se creo un codígo que cambiara directamente la variable, con unas nuevas categorías
```{r}
estrato_etiquetado <- encuesta$Q10_Estrato
estrato_etiquetado = factor(estrato_etiquetado,
                            levels = levels(estrato_etiquetado),
                            labels = c("Bajo","Bajo","Medio","Medio","Alto",NA),
                            ordered = F)
```


```{r}
encuesta <- encuesta %>% 
  mutate(Q10_Estrato = as.character(encuesta$Q10_Estrato))

encuesta$Q10_Estrato[(encuesta$Q10_Estrato ==	 "2 : 1" |  encuesta$Q10_Estrato == "3 : 2")] <- "Bajo"

encuesta$Q10_Estrato[(encuesta$Q10_Estrato ==	 "4 : 3" |  encuesta$Q10_Estrato == "5 : 4")] <- "Medio"

encuesta$Q10_Estrato[(encuesta$Q10_Estrato ==	 "6 : 5"  )] <- "Alto"

encuesta$Q10_Estrato[(encuesta$Q10_Estrato ==	 "8 : No se conoce"  )] <- NA
encuesta <- encuesta %>% 
  mutate(Q10_Estrato = as.factor(encuesta$Q10_Estrato))

```


#### 4. Forzamos los datos de la variable Q08_PAPA para que queden dentro del intervalo [0.0,5.0]
```{r}
encuesta$Q08_PAPA[encuesta$Q08_PAPA == 45 & !is.na(encuesta$Q08_PAPA)] <- 4.5
```


#### 5. Unificamos la escala de los puntajes icfes a una escala de 0 a 500.

Teniendo en cuenta que los puntajes del ICFES registrados en la encuesta pueden tener diferencias en la escala de calificación, dependiendo del año en el que se presentó, hemos decidido unificar las escalas siguiendo las fórmulas implementadas por la UNIMAGDALENA, las cuales están descritas en el sitio web: https://admisiones.unimagdalena.edu.co/inscripcionPRE/conversionICFES.jsp?rnd425615.

Se debe aclarar que la unificación que se hace con las fórmulas mencionadas se ejecuta sobre el puntaje total de la prueba y no sobre los puntajes de cada uno de los módulos que conforman la prueba. En este sentido, se puede tener algún cesgo, ya que los módulos, en distintos años, pueden variar el peso que tienen sobre el puntaje final. No obtaste, nos da un aproximado confiable con el que podemos trabajar.
```{r}
saber11 <- vector("integer", length(encuesta$Q05_Saber11))
for(i in seq_along(encuesta$Q07_FechaSaber11)){
  valor<-0
  if(!is.na(encuesta$Q05_Saber11[[i]]) & encuesta$Q07_FechaSaber11[[i]] < as.Date("2000-01-01")) {
    valor <- (5*(encuesta$Q05_Saber11[[i]]-100))/3
    if(valor >= 0 & valor <= 500){
      saber11[[i]] <- round(valor,0)
    } else {
      saber11[[i]] <- encuesta$Q05_Saber11[[i]]
    }
  } else if(!is.na(encuesta$Q05_Saber11[[i]]) & encuesta$Q07_FechaSaber11[[i]] >= as.Date("2000-01-01") &
        encuesta$Q07_FechaSaber11[[i]] < as.Date("2012-01-01")){
            valor <- encuesta$Q05_Saber11[[i]]*5
            if(valor >= 0 & valor <= 500){
              saber11[[i]] <- valor
            } else {
              saber11[[i]] <- encuesta$Q05_Saber11[[i]]
            }
  } else if(!is.na(encuesta$Q05_Saber11[[i]]) & encuesta$Q07_FechaSaber11[[i]] >= as.Date("2012-01-01")){
            saber11[[i]] <- encuesta$Q05_Saber11[[i]]
  } else{
      saber11[[i]] <- encuesta$Q05_Saber11[[i]]
  }
}

encuesta$Q05_Saber11 = saber11
```



#### 6. Calculamos la edad de los encuestados de acuerdo a su fecha de nacimiento.
```{r}
# Cálculo de la edad
edad <- as.numeric(as.Date("2021-06-30") - encuesta$Q02_FechaNac)/365.25
```





#### 7. Etiquetamos las variables Q24_area y Q26_Divisor como "Correcto/Incorrecto."
```{r}
## Creamos la variable area que contiene la variable Q24_area etiquetada como "Correcto/Incorrecto"  
area <- encuesta$Q24_area
area = factor(area, 
              levels = levels(area),
              labels = c("Incorrecto","Incorrecto","Incorrecto","Correcto","Incorrecto","Incorrecto"),
              ordered = F)

```
```{r}
## Creamos la variable divisor que contiene la variable Q26_Divisor etiquetada como "Correcto/Incorrecto".
divisor = if_else(encuesta$Q26_Divisor..f.es.divisor.de.g.2.==1 & encuesta$Q26_Divisor..f.es.divisor.de.gh.==1 & encuesta$Q26_Divisor..f.es.divisor.de.h.g==1, "Correcto", "Incorrecto")
divisor

```
#### Visualicemos nuevamente nuestros datos y su estructura después de la depuración.

```{r}
glimpse(encuesta)
```

```{r}
summary(encuesta)

```


## HASTA AQUÍ VA LA DEPURACIÓN

## Análisis univariado.

### Género.

```{r}
# t_gen <- table(encuesta$Q01_Genero)
# t_gen
# ```
# ```{r}
# t_gen_p <- t_gen / sum(t_gen) * 100
# t_gen_p
```

```{r}
# bp1 <- barplot(t_gen_p, las = 1, ylim = c(0, 100), col = "lightgreen")
# text(bp1, t_gen_p + 10, paste(round(t_gen_p, 1), "%"))
```

```{r}
# m_gen_p <- as.matrix(t_gen_p)
# bp2 <- barplot(m_gen_p, beside = FALSE, xlim = c(0, 4),
#                ylim = c(0, 110),
#                col = c("blue", "red", "green3"))
# text(1.3, cumsum(m_gen_p) - m_gen_p/2, 
#      paste(rownames(m_gen_p), round((m_gen_p), 1), "%"),
#      adj = 0)
```


```{r}
# pie(t_gen_p, labels = paste(names(t_gen_p), round(t_gen_p, 1), "%"),
#     col = c("blue", "red", "green3"))
```

### Edad.

```{r}
# summary(encuesta$Edad)
```

```{r}
##hist(encuesta$Edad)
```

```{r}
##hist(encuesta$Edad, nclass = 20)
```

```{r}
# paramAnt <- par(no.readonly = TRUE)
# hist(encuesta$Edad, freq = FALSE, nclass = 20, col = "#a0c39f",
#      las = 1, 
#      main = "Distribución de la edad",
#      xlab = "Edad (años)",
#      ylab = "Densidad",
#      ylim = c(0, 0.20),
#      xlim = c(15, 40))
# lines(density(encuesta$Edad), col = "orange", lwd = 3)
# rug(encuesta$Edad)
# par(paramAnt)
```

```{r}
# promedioEdad <- mean(encuesta$Edad)
# medianaEdad <- median(encuesta$Edad)
# desv_Est_Edad <- sd(encuesta$Edad)
# 
# boxplot(encuesta$Edad, horizontal = TRUE,
#         main = "Boxplot para edad", 
#         col = "lightblue",
#         pch = 19, notch = TRUE)
# points(promedioEdad, 
#        1, 
#        pch = 19, 
#        col = c("red", "purple"))
# legend("topright", 
#        title = "Convención",
#        legend = c("Promedio", "Error estandard"), 
#        col = "red", 
#        pch = c(19, NA),
#        lty = c(NA, 1))
# arrows(promedioEdad -  desv_Est_Edad / sqrt(nrow(encuesta)), 1,
#          promedioEdad + desv_Est_Edad / sqrt(nrow(encuesta)), 1,
#          angle = 90,
#          length = 0.1, 
#          code = 3,
#          col = "red")
```





## Análisis bivariado.


```{r}
#with(encuesta, plot(Q10_Estrato, Q08_PAPA, notch = TRUE))
```


```{r}
# encuesta_Estrato1 <- encuesta %>% 
#   filter(Q10_Estrato == "2 : 1")
# dotchart(encuesta_Estrato1$Q08_PAPA)
# summary(encuesta_Estrato1$Q08_PAPA)
```



```{r}
# with(encuesta, plot(Q01_Genero, Q08_PAPA, notch = TRUE))
```


```{r}
# with(encuesta, scatter.smooth(tiempo_usado, Q08_PAPA))
```


```{r}
# with(encuesta, plot(Q27_PorcentDivisor))
# lines(1:nrow(encuesta), rep(pt_p2[3], nrow(encuesta)), 
#       col = "red")
```

```{r}
# enc_acert_p2 <- encuesta %>% 
#   filter(puntaje_pregunta2 == 3)
# enc_no_acert_p2 <- encuesta %>% 
#   filter(puntaje_pregunta2 != 3)
# op <- par(no.readonly = TRUE)
# par(mfrow = c(1, 2))
# prom_Q27 <- mean(enc_acert_p2$Q27)
# with(enc_acert_p2, plot(Q27_PorcentDivisor, ylim = c(0, 100)))
# lines(1:nrow(enc_acert_p2), rep(prom_Q27, nrow(enc_acert_p2)), 
#       col = "red")
# prom_Q27_na <- mean(enc_no_acert_p2$Q27, na.rm = TRUE, ylim = c(0, 100))
# with(enc_no_acert_p2, plot(Q27_PorcentDivisor))
# lines(1:nrow(enc_no_acert_p2), rep(prom_Q27_na, nrow(enc_no_acert_p2)), 
#       col = "red")
# par(op)
```

## Análisis multivariado.

Se considera que existe diferencia entre las carreras de
sistemas y estadística en cuanto 
a los que tienen instalado tanto el R como el RStudio y que también
al interior de cada carrera hay diferencias en los PAPA si se tiene
en cuenta si ya tienen instalados o no el R y el RStudio.

Se piensa que los que tienen instalados ambos programas tienen un
mejor desempeño académico en comparación con los que no lo hicieron.

También se cree que los estudiantes de estadística son los que en
su mayoría han instalado el R y el RStudio. 


### Resumen numérico
```{r}
# encuesta_sist_estad <- encuesta %>% 
#   filter(Q03_Carrera %in% c("2 : Ingeniería de sistemas e informática",
#                             "3 : Estadística")) %>% 
#   droplevels()
# 
# encuesta_sist_estad_resumen <- encuesta_sist_estad %>%
#   group_by(Q03_Carrera) %>% 
#   mutate(num_estud_carrera = n()) %>% 
#   group_by(Carrera_instala, num_estud_carrera) %>% 
#   summarise(num_estud_noNA = sum(!is.na(Q08_PAPA)),
#             prom_PAPA = mean(Q08_PAPA, na.rm = TRUE),
#             desv_PAPA = sd(Q08_PAPA, na.rm = TRUE)) %>% 
#   mutate(porcent_x_carrera = num_estud_noNA / num_estud_carrera * 100)
# encuesta_sist_estad_resumen %>% data.frame()
```

### Gráfica exploratoria.
```{r, fig.height=8, fig.width=8}
# op <- par(no.readonly = TRUE)
# par(mar = op$mar + c(15, 0, 0, 0))
# with(encuesta_sist_estad, 
#      plot(Carrera_instala, Q08_PAPA, notch = TRUE,
#           las = 2, width = sqrt(encuesta_sist_estad_resumen$porcent_x_carrera),
#           col = "lightblue",
#           main = "PAPA vs carrera e instalación de softwares R y RStudio",
#           ylab = "Promedio Académico Ponderado Acumulado",
#           xlab = "",
#           pch = 19))
# with(encuesta_sist_estad_resumen, 
#      points(Carrera_instala, prom_PAPA, 
#            col = "red", pch = 19))
# legend("topleft", legend = c("0 No instaló ni R ni RStudio",
#                              "1 Solo instaló R",
#                              "2 Solo instaló RStudio",
#                              "3 Instaló ambos"))
# legend(0.5, 3.4, legend = c("Promedio"),
#        pch = 19, col = "red")
# text(0.5, 3.1, "El ancho de las cajas es proporcional a la raíz cuadrada del porcentaje de los estudiantes en cada carrera",
#      cex = 0.8, pos = 4)
# par(op)
```

### Análisis.

Se observa que si consideramos a los estudiantes de Sistemas la mayoría
han instalado el R y el RStudio (el 92.3%). Mientras que los de 
estadística solo el 72.2% lo han hecho. Esto es contrario a lo que 
se esperaba.

Se observa que el promedio y la mediana más alta en PAPA lo tienen
los estudiantes de estadística que solo han instalado el R. Mientras
que los promedios más bajos lo tienen los estudiantes de Sistemas
que no han instalado el R o solo el RStudio.

Es importante anotar que en Sistemas solo uno no ha instalado los
dos programas y solo uno ha instalado solo el RStudio. También es
curioso que el de sistemas solo haya instalado el RStudio sin instalar
el R. 

Aparentemente los de estadística que solo han instalado el R tienen
un buen desempeño académico.

Cabo anotar que no hay diferencia significativa en la medianas de los grupos
porque los intervalos de confianza se superponen. Por lo tanto no se
puede inferir que este comportamiento es generalizado.

Sorprende la tendencia del promedio y la mediana del grupo de estadística
que han istalado los dos programas relativamente bajo, contrario a lo
que se esperaba. Esto indica que posiblemente hayan otros factores que
puedan estar asociado al desempeño académico y no solo el hecho de
estar al día con la clase en cuanto a la instalación del software. 

Se puede concluir que, aunque no haya diferencia significativa entre los
grupos si hay una tendencia a tener mejor desempeño en el el PAPA los
estudiantes de estadístca que tienen instalado solo el R, mientras que
los que no lo han instalado los programas el desempeño académico tiene
a se más bajo sin que haya diferencia significativa. 

```{r}

```

Se considera que existe diferencia entre las carreras de
sistemas y estadística en cuanto 
a los que tienen instalado tanto el R como el RStudio y que también
al interior de cada carrera hay diferencias en los PAPA si se tiene
en cuenta si ya tienen instalados o no el R y el RStudio.

Se piensa que los que tienen instalados ambos programas tienen un
mejor desempeño académico en comparación con los que no lo hicieron.

También se cree que los estudiantes de estadística son los que en
su mayoría han instalado el R y el RStudio.


### Resumen numérico
```{r}
# encuesta_sist_estad <- encuesta %>% 
#   filter(Q03_Carrera %in% c("2 : Ingeniería de sistemas e informática",
#                             "3 : Estadística")) %>% 
#   droplevels()
# 
# encuesta_sist_estad_resumen <- encuesta_sist_estad %>%
#   group_by(Q03_Carrera) %>% 
#   mutate(num_estud_carrera = n()) %>% 
#   group_by(Carrera_instala, num_estud_carrera) %>% 
#   summarise(num_estud_noNA = sum(!is.na(Q08_PAPA)),
#             prom_PAPA = mean(Q08_PAPA, na.rm = TRUE),
#             desv_PAPA = sd(Q08_PAPA, na.rm = TRUE)) %>% 
#   mutate(porcent_x_carrera = num_estud_noNA / num_estud_carrera * 100)
# encuesta_sist_estad_resumen %>% data.frame()
```

### Gráfica exploratoria.
```{r, fig.height=8, fig.width=8}
# op <- par(no.readonly = TRUE)
# par(mar = op$mar + c(15, 0, 0, 0))
# with(encuesta_sist_estad, 
#      plot(Carrera_instala, Q08_PAPA, notch = TRUE,
#           las = 2, width = sqrt(encuesta_sist_estad_resumen$porcent_x_carrera),
#           col = "lightblue",
#           main = "PAPA vs carrera e instalación de softwares R y RStudio",
#           ylab = "Promedio Académico Ponderado Acumulado",
#           xlab = "",
#           pch = 19))
# with(encuesta_sist_estad_resumen, 
#      points(Carrera_instala, prom_PAPA, 
#            col = "red", pch = 19))
# legend("topleft", legend = c("0 No instaló ni R ni RStudio",
#                              "1 Solo instaló R",
#                              "2 Solo instaló RStudio",
#                              "3 Instaló ambos"))
# legend(0.5, 3.4, legend = c("Promedio"),
#        pch = 19, col = "red")
# text(0.5, 3.1, "El ancho de las cajas es proporcional a la raíz cuadrada del porcentaje de los estudiantes en cada carrera",
#      cex = 0.8, pos = 4)
# par(op)
```

### Análisis.

Se observa que si consideramos a los estudiantes de Sistemas la mayoría
han instalado el R y el RStudio (el 92.3%). Mientras que los de 
estadística solo el 72.2% lo han hecho. Esto es contrario a lo que 
se esperaba.

Se observa que el promedio y la mediana más alta en PAPA lo tienen
los estudiantes de estadística que solo han instalado el R. Mientras
que los promedios más bajos lo tienen los estudiantes de Sistemas
que no han instalado el R o solo el RStudio.

Es importante anotar que en Sistemas solo uno no ha instalado los
dos programas y solo uno ha instalado solo el RStudio. También es
curioso que el de sistemas solo haya instalado el RStudio sin instalar
el R. 

Aparentemente los de estadística que solo han instalado el R tienen
un buen desempeño académico.

Cabo anotar que no hay diferencia significativa en la medianas de los grupos
porque los intervalos de confianza se superponen. Por lo tanto no se
puede inferir que este comportamiento es generalizado.

Sorprende la tendencia del promedio y la mediana del grupo de estadística
que han istalado los dos programas relativamente bajo, contrario a lo
que se esperaba. Esto indica que posiblemente hayan otros factores que
puedan estar asociado al desempeño académico y no solo el hecho de
estar al día con la clase en cuanto a la instalación del software. 

Se puede concluir que aunque no haya diferencia significativa entre los
grupos si hay una tendencia a tener mejor desempeño en el el PAPA los
estudiantes de estadístca que tienen instalado solo el R, mientras que
los que no lo han instalado los programas el desempeño académico tiene
a se más bajo sin que haya diferencia significativa. 





#
#
#
## KARINA

Pregunta bivariada. Cruce de variable  PAPA, con la carrera  

¿Los estudiantes que tienen mejor PAPA se encuentran en la carrera de ing en sistemas?

El supuesto que se tiene en esta pregunta es que si, los estudiantes que estan cursando la carrera de ingenieria en sistemas tiene un PAPA mas alto que quienes están cursando estadística, esto debido a que, se podría pensar que los ingenieros en sistemas son mas dedicados ya que su carrera es muy demandada, entonces siempre se seleccionan los mejores, además,saben mas de manejo computacional que un estudiante de estadística. 

Para responder a esta pregunta, en primer lugar lo que hizo fue analizar que carreras están cursando los estudiantes del curso de estadistica descriptiva y exploratoria dentro de las respuestas se encontró diversidad de carreras, de las cuales se destacan estadística, ing de sistemas, ing industrial, ing física, y otra. Cabe destacar, que las carreras que mas número de estudiantes presenta es ing en sistemas y estadistica. De allí, que fueran estas dos las elegidas para realizar el cruce bivariado. 

A continuación se presenta una tabla donde se muestra la cantidad de estudiantes por cada carrera y se saca también el promedio del PAPA. En la carrera de estadísitca hay exactamente 54 estudiantes, y en ing en sistemas 26. Una diferencia que alcanza a ser el doble.Es normal que suceda esto, pues el curso de estadítica descriptiva y exploratoría es obligatorio para quienes estudian estadistica y optativo para quienes hacen otras carreras, de allí que se perciba mayor presencia de los estudiantes de estadística. 

En este sentido, para hallar el Promedio acumulado ponderado (PAPA) que tiene una escala de 1 a 5, se sumó cada PAPA reportado por los estudiantes de estadistica y de ing en sistemas, ambos por separado, y posterioemnte se dividió por la cantidad de personas de las dos carreras

A partir de la tabla que se realizó, se procedió a graficar un boxplot. Donde se muestra, a través de una caja que divide los datos en cuatro cuartiles. El 50% de los estudiantes presentan un PAPA aproximado de 4,03 o menos y los de ing en sistemas de 4,06. Una diferencia demasiado pequeña a lo que se tenía pensado. Entonces, esto nos permite ver que la hipotesis que se planteó es verdadera. Sin embargo, hay que resaltar que la diferencia entre ambas es de tan solo 0,03 centésimas. 

También hay que mencionar que en las dos carreras hay personas con un PAPA de casi 4,6. Mientras que, el valor mínimo de PAPA lo presentan los de estadística con un 3,0 y el de los ingenieros es de mas o menos 3,4. (Ver gráfica 1:  Carrera vs PAPA)
        
```{r}
encuesta_sist_estad <- encuesta %>% 
  filter(Q03_Carrera %in% c("2 : Ingeniería de sistemas e informática",
                            "3 : Estadística")) %>% 
  droplevels()

encuesta_sist_estad_resumen <- encuesta_sist_estad %>%
  group_by(Q03_Carrera) %>% 
  mutate(num_estud_carrera = n()) %>% 
  group_by(Q03_Carrera, num_estud_carrera) %>% 
  summarise(num_estud_noNA = sum(!is.na(Q08_PAPA)),
            prom_PAPA = mean(Q08_PAPA, na.rm = TRUE),
            desv_PAPA = sd(Q08_PAPA, na.rm = TRUE)) %>% 
  mutate(porcent_x_carrera = num_estud_noNA / num_estud_carrera * 100)
encuesta_sist_estad_resumen %>% data.frame()
```
### Gráfica exploratoria Carrera Vs PAPA

```{r}
boxplot(Q08_PAPA~ Q03_Carrera, data = encuesta_sist_estad, col = "bisque" , log = "y")
title("Carrera VS PAPA")
points(encuesta_sist_estad_resumen$Q03_Carrera, encuesta_sist_estad_resumen$prom_PAPA, col = "red", pch = 19)
legend("bottomright", legend = c("PromedioPAPA"), pch =19, col = "red")
```
A partir de la presente gráfica, 

Pregunta multivariada

¿El puntaje alto en las pruebas Saber11 y el PAPA de los estudiantes del curso de estadística descriptiva y exploratoria dependen de su estrato socioeconómico?

En el grupo después de discutir esta pregunta, se llegó a la conclusión, que nada tiene que ver el hecho de pertenecer a determinado estrato con el puntaje de las pruebas saber 11 y el PAPA, pues se ha visto en muchas ocasiones como en los estratos bajos y altos hay gente con muy buenos resultados académicos. 


```{r}
with(encuesta, plot(Q05_Saber11, Q08_PAPA,main="Saber11 vs PAPA",xlab="Saber11", ylab="PAPA", col = as.factor(encuesta$Q05_Saber11),pch=19, ylim=c(3,4.7),xlim=c(1,8)))
lines(lowess(subset(encuesta, Q10_Estrato == "Bajo")[,c("Q05_Saber11")], subset(encuesta, Q10_Estrato == "Bajo")[,c("Q08_PAPA")]), col = "magenta1", lwd = 2)
lines(lowess(subset(encuesta, Q10_Estrato == "Medio")[,c("Q05_Saber11")], subset(encuesta, Q10_Estrato == "Medio")[,c("Q08_PAPA")]), col = "bisque", lwd = 2)
lines(lowess(subset(encuesta, Q10_Estrato == "Alto")[,c("Q05_Saber11")], subset(encuesta, Q10_Estrato == "Alto")[,c("Q08_PAPA")]), col = "cyan", lwd = 2)
legend("bottomright" ,legend = c("Bajo", "Medio", "Alto"), col = c("Blue","#cc6666"), pch = c(19, 19), cex = 0.7, box.lwd = 1)
```

```{r}
 
```

### Estrato socioeconomico VS PAPA y pruebas saber11



### HASTA AQUÍ VA KARINA

## LAURA
Pregunta Bivariada

¿Qué estrato tienen mejor PAPA?

El supuesto que se tiene a la hora de plantear esta pregunta, es que los estudiantes que pertenencen a un estrato mas alto son quienes tienen mejor PAPA, esto debido a que, han tenido más posibilidades de acceder a mejores recursos, tanto económicos como académicos.

```{r}
estratos_sin_na <- encuesta %>%
  filter(Q10_Estrato == "Alto" | Q10_Estrato == "Medio" | Q10_Estrato == "Bajo")
  

tabla_PAPA <- estratos_sin_na %>%
  group_by(Q10_Estrato) %>% 
  summarise(num_estud = sum(!is.na(Q08_PAPA)),
            prom_PAPA = mean(Q08_PAPA, na.rm = TRUE),
            desv_PAPA = sd(Q08_PAPA, na.rm = TRUE)) 
tabla_PAPA <- data.frame(tabla_PAPA)
tabla_PAPA
```

```{r, fig.height=8, fig.width=8}

 with(encuesta, 
      plot(Q10_Estrato, Q08_PAPA, notch = TRUE,
           las = 2,
           col = "lightblue",
           main = "PAPA vs estrato",
           ylab = "Promedio Académico Ponderado Acumulado",
           xlab = "Estrato",
           pch = 19))
 with(tabla_PAPA, 
      points(Q10_Estrato, prom_PAPA, 
            col = "red", pch = 19))
```

Pregunta Multivariada

¿El genero que tiene mejor promedio PAPA depende del estrato en que este?



### HASTA AQUÍ VA LAURA

## ALEX







### HASTA AQUÍ VA ALEX

## JOHAN






### HASTA AQUÍ VA JOHAN


## JHON